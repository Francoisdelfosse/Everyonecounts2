<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>World Population & Spending</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-dragdata@2.0.0"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap');
  body {
    font-family: 'Bebas Neue', sans-serif;
    background-color: #111;
    color: white;
    text-align: center;
    margin: 0;
    padding: 0;
  }
  #population {
    font-size: 8vw;
    margin: 10px 0;
  }
  canvas {
    max-width: 90vw;
    max-height: 80vh;
  }
</style>
</head>
<body>

<div id="population">Loading...</div>
<canvas id="pieChart"></canvas>

<script>
  // Estimate current population
  function estimatePopulation() {
    // UN estimate: ~8,100,000,000 in Jan 2025
    const startPop = 8100000000;
    const yearlyGrowth = 75000000; // ~75M per year
    const startDate = new Date('2025-01-01T00:00:00Z');
    const now = new Date();
    const secondsInYear = 365 * 24 * 60 * 60;
    const elapsedSec = (now - startDate) / 1000;
    const pop = startPop + (yearlyGrowth * (elapsedSec / secondsInYear));
    return Math.floor(pop);
  }

  // Display population
  function updatePopulation() {
    document.getElementById('population').textContent = estimatePopulation();
  }
  updatePopulation();
  setInterval(updatePopulation, 1000);

  // Data for pie chart
  const labels = [
    'Social Protection', 'Health', 'General Public Services',
    'Economic Affairs', 'Education', 'Debt Servicing',
    'Public Order and Safety', 'Housing & Community Amenities',
    'Recreation, Culture & Religion', 'Environmental Protection', 'Other'
  ];
  const data = [22.0, 8.0, 6.2, 6.1, 5.0, 4.5, 3.5, 3.0, 2.5, 2.0, 37.2]; // Sum ~100

  const ctx = document.getElementById('pieChart').getContext('2d');
  const pieChart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: labels,
      datasets: [{
        data: data,
        backgroundColor: [
          '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
          '#FF9F40', '#C9CBCF', '#E7E9ED', '#8DD3C7', '#FFFFB3', '#BEBADA'
        ]
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'right', labels: { color: 'white' } },
      },
      dragData: true,
      dragDataRound: 1,
      onDragStart: function(e, datasetIndex, index, value) {},
      onDrag: function(e, datasetIndex, index, value) {},
      onDragEnd: function(e, datasetIndex, index, value) {
        const total = pieChart.data.datasets[0].data.reduce((a, b) => a + b, 0);
        // Normalize to keep total ~100
        pieChart.data.datasets[0].data = pieChart.data.datasets[0].data.map(v => v * (100 / total));
        pieChart.update();
      }
    }
  });
</script>

</body>
</html>
